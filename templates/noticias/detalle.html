{% extends 'base.html' %}
{% load youtube_extras %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<div class="container py-5">
  <div class="row g-4">
    <!-- Contenido principal -->
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm mb-4">
        {% if noticia.imagen %}
        <img src="{{ noticia.imagen.url }}" class="card-img-top" style="object-fit:cover; max-height:340px;">
        {% endif %}
        <div class="card-body">
          <span class="badge bg-success mb-2">{{ noticia.get_categoria_display }}</span>
          <h1 class="card-title display-5 fw-bold">{{ noticia.titulo }}</h1>
          <div class="mb-3 text-muted small">
            <i class="bi bi-calendar-event"></i> {{ noticia.fecha_publicacion|date:'d/m/Y H:i' }}
            {% if noticia.autor %} &nbsp;|&nbsp; <i class="bi bi-person"></i> {{ noticia.autor }} {% endif %}
          </div>
          <div class="card-text fs-5 mb-4">{{ noticia.contenido|linebreaks }}</div>
          {% if noticia.video_url %}
            {% if 'youtube.com' in noticia.video_url or 'youtu.be' in noticia.video_url %}
              <div class="ratio ratio-16x9 my-3">
                <iframe src="https://www.youtube.com/embed/{{ noticia.video_url|youtube_id }}" frameborder="0" allowfullscreen></iframe>
              </div>
            {% endif %}
          {% endif %}
          {% if noticia.archivo %}
            <a href="{{ noticia.archivo.url }}" class="btn btn-outline-secondary mt-2" download><i class="bi bi-paperclip"></i> Descargar archivo adjunto</a>
          {% endif %}
        </div>
      </div>
    </div>
    <!-- Lateral: artículos recientes -->
    <div class="col-lg-4">
      <div class="mb-4">
        <h5 class="fw-bold mb-3">Artículos recientes</h5>
        {% for n in recientes %}
        <div class="card mb-3 border-0 shadow-sm">
          {% if n.imagen %}
          <img src="{{ n.imagen.url }}" class="card-img-top" style="object-fit:cover; max-height:90px;">
          {% endif %}
          <div class="card-body p-2">
            <span class="badge bg-success mb-1">{{ n.get_categoria_display }}</span>
            <h6 class="card-title mb-1"><a href="{% url 'noticia_detalle' n.id %}" class="text-decoration-none">{{ n.titulo }}</a></h6>
            <small class="text-muted"><i class="bi bi-calendar-event"></i> {{ n.fecha_publicacion|date:'d/m/Y' }}</small>
          </div>
        </div>
        {% empty %}
        <div class="text-muted">No hay más artículos.</div>
        {% endfor %}
      </div>
    </div>
  </div>
  <a href="{% url 'noticias' %}" class="btn btn-link mt-3"><i class="bi bi-arrow-left"></i> Volver a noticias</a>
</div>
{% endblock %} 